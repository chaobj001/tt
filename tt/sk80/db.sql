/*
SQLyog Enterprise - MySQL GUI v6.56
MySQL - 5.1.38-community : Database - sk80
*********************************************************************
*/

/*!40101 SET NAMES utf8 */;

/*!40101 SET SQL_MODE=''*/;

/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;

CREATE DATABASE /*!32312 IF NOT EXISTS*/`sk80` /*!40100 DEFAULT CHARACTER SET utf8 */;

USE `sk80`;

/*Table structure for table `sk_category` */

DROP TABLE IF EXISTS `sk_category`;

CREATE TABLE `sk_category` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `pid` int(10) unsigned NOT NULL DEFAULT '0',
  `name` char(30) NOT NULL DEFAULT '',
  `slug` char(30) NOT NULL DEFAULT '',
  `path` char(255) NOT NULL DEFAULT '',
  `count` int(10) unsigned NOT NULL DEFAULT '0',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=53 DEFAULT CHARSET=utf8;

/*Data for the table `sk_category` */

insert  into `sk_category`(`id`,`pid`,`name`,`slug`,`path`,`count`) values (20,0,'图书','books','0,20',0),(17,0,'计算机','computer','0,17',21);

/*Table structure for table `sk_content` */

DROP TABLE IF EXISTS `sk_content`;

CREATE TABLE `sk_content` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `title` char(255) NOT NULL DEFAULT '',
  `slug` char(255) NOT NULL DEFAULT '',
  `keywords` char(255) NOT NULL DEFAULT '',
  `description` text,
  `type` char(5) NOT NULL DEFAULT 'post',
  `status` char(10) NOT NULL DEFAULT 'publish',
  `position` tinyint(1) unsigned NOT NULL DEFAULT '0',
  `cid` smallint(3) unsigned NOT NULL DEFAULT '0',
  `created_uid` smallint(5) unsigned NOT NULL DEFAULT '0',
  `updated_uid` smallint(5) unsigned NOT NULL DEFAULT '0',
  `created_date` int(10) unsigned NOT NULL DEFAULT '0',
  `updated_date` int(10) unsigned NOT NULL DEFAULT '0',
  `comment_count` int(10) unsigned NOT NULL DEFAULT '0',
  `is_comment` tinyint(1) unsigned NOT NULL DEFAULT '0',
  `password` char(15) NOT NULL DEFAULT '',
  PRIMARY KEY (`id`),
  KEY `type` (`type`),
  KEY `status` (`status`)
) ENGINE=MyISAM AUTO_INCREMENT=69 DEFAULT CHARSET=utf8;

/*Data for the table `sk_content` */

insert  into `sk_content`(`id`,`title`,`slug`,`keywords`,`description`,`type`,`status`,`position`,`cid`,`created_uid`,`updated_uid`,`created_date`,`updated_date`,`comment_count`,`is_comment`,`password`) values (52,'hhhhhhhhhhhh','','',NULL,'post','publish',0,17,1,0,1268027676,0,0,1,''),(51,'dddddd','','','','post','publish',0,17,1,1,1268019657,1268027257,0,1,''),(41,'nginx rewrite 参数和例子nginx rewrite 参数和例子','','','','post','publish',0,17,1,1,1267374315,1267500422,0,1,''),(53,'aaaaaaaaaa','','','','post','publish',0,17,1,1,1268029213,1268029217,0,1,''),(54,'code','','','','post','publish',0,17,1,1,1268030013,1268030056,0,1,''),(55,'ggggg','','','','post','publish',0,17,1,1,1268030164,1268030193,0,1,''),(56,'1111','','',NULL,'post','publish',0,17,1,0,1268030308,0,0,1,''),(57,'ddddd','','',NULL,'post','publish',0,17,1,0,1268030519,0,0,1,''),(58,'ggggggggggggggggggggggggg','','',NULL,'post','publish',0,17,1,0,1268030869,0,0,1,''),(59,'ggggggggggggggggggggggggg','','',NULL,'post','publish',0,17,1,0,1268030870,0,0,1,''),(60,'eeeee','','',NULL,'post','publish',0,17,1,0,1268031190,0,0,1,''),(61,'sssss','','','','post','publish',0,17,1,1,1268031226,1268031357,0,1,''),(62,'sssssssss','','',NULL,'post','publish',0,17,1,0,1268031917,0,0,1,''),(63,'fffffffffffffff','','',NULL,'post','publish',0,17,1,0,1268032023,0,0,1,''),(64,'ssssssssssssssssssss','','',NULL,'post','publish',0,17,1,0,1268032136,0,0,1,''),(65,'fffffffffffffff','','',NULL,'post','publish',0,17,1,0,1268032433,0,0,1,''),(66,'jjjjjjjjjjjjjjj','','',NULL,'post','publish',0,17,1,0,1268032994,0,0,1,''),(67,'sssssssss','','',NULL,'post','publish',0,17,1,0,1268033017,0,0,1,''),(68,'ddddddddddd','','','','post','publish',0,17,1,1,1268034381,1268035830,0,1,'');

/*Table structure for table `sk_content_part` */

DROP TABLE IF EXISTS `sk_content_part`;

CREATE TABLE `sk_content_part` (
  `id` int(10) unsigned NOT NULL,
  `content` text,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

/*Data for the table `sk_content_part` */

insert  into `sk_content_part`(`id`,`content`) values (56,'[code=php]<br />/**<br /> * 这个方法将去除魔法转义斜杠， 如果魔法转义打开<br /> * 自动去除$_GET, $_POST, $_COOKIE<br /> */<br />function fix_input_quotes() {<br />    $in = array(&amp;$_GET, &amp;$_POST, &amp;$_COOKIE);<br />    while (list($k,$v) = each($in)) {<br />        foreach ($v as $key =&gt; $val) {<br />            if (!is_array($val)) {<br />                $in[$k][$key] = stripslashes($val); continue;<br />            }<br />            $in[] =&amp; $in[$k][$key];<br />        }<br />    }<br />    unset($in);<br />} // fix_input_quotes<br />[/code]'),(57,'[code=html]<br />&lt;?php<br />function get_request_method() {<br />    if (isset($_SERVER[\'HTTP_X_REQUESTED_WITH\']) &amp;&amp; $_SERVER[\'HTTP_X_REQUESTED_WITH\'] == \'XMLHttpRequest\')<br />        return \'AJAX\';<br />    else<br />        return $_SERVER[\'REQUEST_METHOD\'];<br />}<br />?&gt;<br />[/code]<br />'),(58,'[code=php]<br />//如果PHP开启了魔法转移则自动去除转义<br />if (get_magic_quotes_gpc()) {<br />    fix_input_quotes();<br />}<br />[/code]<br />'),(51,'[code=php]<br />&lt;?php<br />    function flush()<br />    {<br />        $this-&gt;last_result = null;<br />        $this-&gt;last_query = null;<br />        $this-&gt;query_start = null;<br />        $this-&gt;col_info = null;<br />    }<br /><br />    function get_page_results($query=null)<br />    {<br />        $query = preg_replace(\"/||s/\", \" \", $query);<br />        preg_match(\"~select(.*?) from (.*) limit ~ims\", $query, $m);<br />        //print_r($m);<br />        $total_query = \"SELECT COUNT(*) FROM {$m[2]}\";<br />        $this-&gt;num_rows_all = $this-&gt;get_var($total_query,$x=0,$y=0);<br />        $this-&gt;query($query);<br />    }<br />?&gt;<br />[/code][code=javascript]<br />            if(error_msg != \'){<br />                tip.html(error_msg).slideDown(\"slow\");<br />                return false;<br />            }<br />[/code]<br />'),(52,'[code=plain]<br /># RSS<br />#RewriteRule ^rss/([0-9]+)?/?$ rss.php?cid=$1 [QSA,L]<br />#RewriteRule ^rss/([^/]+)/?$ rss.php?url=$1 [QSA,L]<br /><br /># �û�<br />#RewriteRule ^uid/([0-9]+)/?([0-9]+)?/?$ index.php?action=article&amp;uid=$1&amp;page=$2 [QSA,L]<br />#RewriteRule ^user/([^/]+)/?([0-9]+)?/?$ index.php?action=article&amp;user=$1&amp;page=$2 [QSA,L]<br /><br />[/code]<br />'),(53,'[code=html]#next-prev{margin:0 0 20px 30px;}<br />#next-prev li{margin:4px 0; line-height:22px; list-style:circle;}<br />#next-prev li:hover{list-style:disc;}<br />#next-prev li strong{font-size:1em;}<br />[/code]'),(54,'[code=php]&lt;?php<br />highlight_string(\'&lt;?php phpinfo(); ?&gt;\');<br />?&gt; <br />[/code]'),(55,'[code=php]    public function categoryAction($args=null)<br />    {<br />        global $tpl;<br />        try{<br />            if(!isset($args[\'slug\']) || !isset($this-&gt;categories[trim($args[\'slug\'])]))<br />                throw new Exception(\'分类不能为空或分类不存在\');<br /><br />            $page = new Page;<br />            $page-&gt;Page = $args[\'page\'];<br />            $page-&gt;Url = SITE_URL.\'category/\'.trim($args[\'slug\']).\'/\';<br />            $page-&gt;Condition = \'/\';<br />            //$category = new Category(\'slug\', trim($args[\'slug\']));<br /><br />            $category = $this-&gt;categories[trim($args[\'slug\'])];<br /><br />            $result = Article::findByCid($category-&gt;id, $page);<br />            $page-&gt;Count = $result[\'count\'];<br /><br />        } catch(Exception $e) {<br />            die($e-&gt;getMessage());<br />        }<br /><br />        $tpl-&gt;assign(\'post_list\', $result[\'res\']);<br />        $tpl-&gt;assign(\'category\', $category-&gt;name);<br />        $tpl-&gt;assign(\'page_nav\', $page-&gt;getPage());<br />        $tpl-&gt;display(DEFAULT_TEMPLATE.\'/list.html\');<br />    }<br />[/code]'),(41,'<p>推荐参考地址：<br />Mailing list ARChives 官方讨论区<br />&lt;a href=\"\\\" http:=\"\" marc.info=\"\" ?l=\"nginx\\\"\"\"&gt;http://marc.info/?l=nginx</p><p>Nginx 常见应用技术指南[Nginx Tips]<br />&lt;a href=\"\\\" http:=\"\" bbs.linuxtone.org=\"\" thread-1685-1-1.html\\=\"\"&gt;http://bbs.linuxtone.org/thread-1685-1-1.html</p><p><strong>本日志内容来自互联网和平日使用经验，整理一下方便日后参考。</strong><br /></p><p><strong>正则表达式匹配，其中：</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;* ~ 为区分大小写匹配<li>* ~* 为不区分大小写匹配</li><li>* !~和!~*分别为区分大小写不匹配及不区分大小写不匹配</li><p><strong>文件及目录匹配，其中：</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;* -f和!-f用来判断是否存在文件<li>* -d和!-d用来判断是否存在目录</li><li>* -e和!-e用来判断是否存在文件或目录</li><li>* -x和!-x用来判断文件是否可执行</li><p><strong>flag标记有：</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;* last 相当于Apache里的[L]标记，表示完成rewrite<li>* break 终止匹配, 不再匹配后面的规则</li><li>* redirect 返回302临时重定向 地址栏会显示跳转后的地址</li><li>* permanent 返回301永久重定向 地址栏会显示跳转后的地址</li><p><strong>一些可用的全局变量有，可以用做条件判断(待补全)</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;$args<li>$content_length</li><li>$content_type</li><li>$document_root</li><li>$document_uri</li><li>$host</li><li>$http_user_agent</li><li>$http_cookie</li><li>$limit_rate</li><li>$request_body_file</li><li>$request_method</li><li>$remote_addr</li><li>$remote_port</li><li>$remote_user</li><li>$request_filename</li><li>$request_uri</li><li>$query_string</li><li>$scheme</li><li>$server_protocol</li><li>$server_addr</li><li>$server_name</li><li>$server_port</li><li>$uri</li><p><strong>结合QeePHP的例子</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;if (!-d $request_filename) {<li>rewrite ^/([a-z-A-Z]+)/([a-z-A-Z]+)/?(.*)$ /index.php?namespace=user&amp;controller=$1&amp;action=$2&amp;$3 last;</li><li>rewrite ^/([a-z-A-Z]+)/?$ /index.php?namespace=user&amp;controller=$1 last;</li><li>break;</li><p><strong>多目录转成参数</strong><br />abc.domian.com/sort/2 =&gt; abc.domian.com/index.php?act=sort&amp;name=abc&amp;id=2</p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;if ($host ~* (.*)\\\\.domain\\\\.com) { <li>set $sub_name $1;&nbsp; &nbsp; </li><li>rewrite ^/sort\\\\/(\\\\d+)\\\\/?$ /index.php?act=sort&amp;cid=$sub_name&amp;id=$1 last; </li><li>}</li><p><strong>目录对换</strong><br />/123456/xxxx -&gt; /xxxx?id=123456</p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;rewrite ^/(\\\\d+)/(.+)/ /$2?id=$1 last;<p><strong>例如下面设定nginx在用户使用ie的使用重定向到/nginx-ie目录下：</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;if ($http_user_agent ~ MSIE) {<li>rewrite ^(.*)$ /nginx-ie/$1 break;</li><li>}</li><p><strong>目录自动加“/”</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;if (-d $request_filename){<li>rewrite ^/(.*)([^/])$ http://$host/$1$2/ permanent;</li><li>}</li><p><strong>禁止htaccess</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;location ~/\\\\.ht {<li>	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;deny all;</li><li>&nbsp; &nbsp; &nbsp;}</li><p><strong>禁止多个目录</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;location ~ ^/(cron|templates)/ {<li>	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;deny all;</li><li>		 break;</li><li>	&nbsp; &nbsp; &nbsp;}</li><p><strong>禁止以/data开头的文件</strong><br />可以禁止/data/下多级目录下.log.txt等请求;</p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;location ~ ^/data {<li>	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;deny all;</li><li>&nbsp; &nbsp; &nbsp;}</li><p><strong>禁止单个目录</strong><br />不能禁止.log.txt能请求</p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;location /searchword/cron/ {<li>	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;deny all;</li><li>	&nbsp; &nbsp; &nbsp;}</li><p><strong>禁止单个文件</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;location ~ /data/sql/data.sql {<li>	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;deny all;</li><li>	&nbsp; &nbsp; &nbsp;}</li><p><strong>给favicon.ico和robots.txt设置过期时间;</strong><br />这里为favicon.ico为99天,robots.txt为7天并不记录404错误日志</p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;location ~(favicon.ico) {<li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; log_not_found off;</li><li>		 expires 99d;</li><li>		 break;</li><li>	&nbsp; &nbsp; &nbsp;}</li><li>&nbsp;</li><li>	&nbsp; &nbsp; &nbsp;location ~(robots.txt) {</li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; log_not_found off;</li><li>		 expires 7d;</li><li>		 break;</li><li>&nbsp; &nbsp; &nbsp;}</li><p><strong>设定某个文件的过期时间;这里为600秒，并不记录访问日志</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;location ^~ /html/scripts/loadhead_1.js {<li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; access_log&nbsp; &nbsp;off;</li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; root /opt/lampp/htdocs/web;</li><li>		 expires 600;</li><li>		 break;</li><li>&nbsp;&nbsp; &nbsp; &nbsp;}</li><p><strong>文件反盗链并设置过期时间</strong><br />这里的return 412 为自定义的http状态码，默认为403，方便找出正确的盗链的请求<br />“rewrite ^/ http://leech.c1gstudio.com/leech.gif;”显示一张防盗链图片<br />“access_log   off;”不记录访问日志，减轻压力<br />“expires 3d”所有文件3天的浏览器缓存</p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;location ~* ^.+\\\\.(jpg|jpeg|gif|png|swf|rar|zip|css|js)$ {<li>		valid_referers none blocked *.c1gstudio.com *.c1gstudio.net localhost 208.97.167.194;</li><li>if ($invalid_referer) {</li><li>		&nbsp; &nbsp; rewrite ^/ http://leech.c1gstudio.com/leech.gif;</li><li>		&nbsp; &nbsp; return 412;</li><li>&nbsp; &nbsp; break;</li><li>		}</li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; access_log&nbsp; &nbsp;off;</li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; root /opt/lampp/htdocs/web;</li><li>		 expires 3d;</li><li> break;</li><li>	&nbsp; &nbsp; &nbsp;}</li><p><strong>只充许固定ip访问网站，并加上密码</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;root&nbsp; /opt/htdocs/www;<li>		allow&nbsp; &nbsp;208.97.167.194;</li><li>		allow&nbsp; &nbsp;222.33.1.2;</li><li>		allow&nbsp; &nbsp;231.152.49.4;</li><li>		deny&nbsp; &nbsp; all;</li><li>		auth_basic \\\"C1G_ADMIN\\\";</li><li>auth_basic_user_file htpasswd;</li><p><strong>将多级目录下的文件转成一个文件，增强seo效果</strong><br />/job-123-456-789.html 指向/job/123/456/789.html</p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;rewrite ^/job-([0-9]+)-([0-9]+)-([0-9]+)\\\\.html$ /job/$1/$2/jobshow_$3.html last;<p><strong>将根目录下某个文件夹指向2级目录</strong><br />如/<strong>shanghai</strong>job/ 指向 /area/<strong>shanghai</strong>/<br />如果你将last改成permanent，那么浏览器地址栏显是/location/shanghai/</p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;rewrite ^/([0-9a-z]+)job/(.*)$ /area/$1/$2 last;<p>上面例子有个问题是访问/shanghai 时将不会匹配</p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;rewrite ^/([0-9a-z]+)job$ /area/$1/ last;<li>rewrite ^/([0-9a-z]+)job/(.*)$ /area/$1/$2 last;</li><p>这样/shanghai 也可以访问了，但页面中的相对链接无法使用，<br />如./list_1.html真实地址是/area/shanghia/list_1.html会变成/list_1.html,导至无法访问。</p><p>那我加上自动跳转也是不行咯<br />(-d $request_filename)它有个条件是必需为真实目录，而我的rewrite不是的，所以没有效果</p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;if (-d $request_filename){<li>rewrite ^/(.*)([^/])$ http://$host/$1$2/ permanent;</li><li>}</li><p>知道原因后就好办了，让我手动跳转吧</p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;rewrite ^/([0-9a-z]+)job$ /$1job/ permanent;<li>rewrite ^/([0-9a-z]+)job/(.*)$ /area/$1/$2 last;</li><p><strong>文件和目录不存在的时候重定向：</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;if (!-e $request_filename) {<li>proxy_pass http://127.0.0.1;</li><li>}</li><p><strong>域名跳转</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;server<li>&nbsp;&nbsp; &nbsp; {</li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; listen&nbsp; &nbsp; &nbsp; &nbsp;80;</li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; server_name&nbsp; jump.c1gstudio.com;</li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; index index.html index.htm index.php;</li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; root&nbsp; /opt/lampp/htdocs/www;	</li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rewrite ^/ http://www.c1gstudio.com/;</li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; access_log&nbsp; off;</li><li>&nbsp;&nbsp; &nbsp; }</li><p><strong>多域名转向</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;server_name&nbsp; www.c1gstudio.com www.c1gstudio.net;<li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; index index.html index.htm index.php;</li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; root&nbsp; /opt/lampp/htdocs;</li><li>	if ($host ~ \\\"c1gstudio\\\\.net\\\") {</li><li>rewrite ^(.*) http://www.c1gstudio.com$1 permanent;</li><li>	}</li><p><strong>三级域名跳转</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;if ($http_host ~* \\\"^(.*)\\\\.i\\\\.c1gstudio\\\\.com$\\\") {<li>rewrite ^(.*) http://top.yingjiesheng.com$1;</li><li>		break;</li><li>}</li><p><strong>域名镜向</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;server<li>&nbsp;&nbsp; &nbsp; {</li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; listen&nbsp; &nbsp; &nbsp; &nbsp;80;</li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; server_name&nbsp; mirror.c1gstudio.com;</li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; index index.html index.htm index.php;</li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; root&nbsp; /opt/lampp/htdocs/www;	</li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rewrite ^/(.*) http://www.c1gstudio.com/$1 last;</li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; access_log&nbsp; off;</li><li>&nbsp;&nbsp; &nbsp; }</li><p><strong>某个子目录作镜向</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;location ^~ /zhaopinhui {<li>		&nbsp; rewrite ^.+ http://zph.c1gstudio.com/ last;</li><li>		&nbsp; break;</li><li>	&nbsp; &nbsp; &nbsp;}</li><p><strong>discuz ucenter home (uchome) rewrite</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;rewrite ^/(space|network)-(.+)\\\\.html$ /$1.php?rewrite=$2 last;<li>		rewrite ^/(space|network)\\\\.html$ /$1.php last;</li><li>		rewrite ^/([0-9]+)$ /space.php?uid=$1 last;</li><p><strong>discuz 7 rewrite</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;rewrite ^(.*)/archiver/((fid|tid)-[\\\\w\\\\-]+\\\\.html)$ $1/archiver/index.php?$2 last;<li>		rewrite ^(.*)/forum-([0-9]+)-([0-9]+)\\\\.html$ $1/forumdisplay.php?fid=$2&amp;page=$3 last;</li><li>		rewrite ^(.*)/thread-([0-9]+)-([0-9]+)-([0-9]+)\\\\.html$ $1/viewthread.php?tid=$2&amp;extra=page\\\\%3D$4&amp;page=$3 last;</li><li>rewrite ^(.*)/profile-(username|uid)-(.+)\\\\.html$ $1/viewpro.php?$2=$3 last;</li><li>		rewrite ^(.*)/space-(username|uid)-(.+)\\\\.html$ $1/space.php?$2=$3 last;</li><li>		rewrite ^(.*)/tag-(.+)\\\\.html$ $1/tag.php?name=$2 last;</li><p><strong>给discuz某版块单独配置域名</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;server_name&nbsp; bbs.c1gstudio.com news.c1gstudio.com;<li>&nbsp;</li><li>&nbsp; &nbsp; &nbsp;location = / {</li><li>	&nbsp; &nbsp; &nbsp; &nbsp; if ($http_host ~ news\\\\.c1gstudio.com$) {</li><li>		&nbsp; rewrite ^.+ http://news.c1gstudio.com/forum-831-1.html last;</li><li>		&nbsp; break;</li><li>}</li><li>	&nbsp; &nbsp; &nbsp;}</li><p><strong>discuz ucenter 头像 rewrite 优化</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;location ^~ /ucenter {<li>		&nbsp; &nbsp; &nbsp;location ~ .*\\\\.php?$</li><li>		&nbsp; &nbsp; &nbsp;{</li><li>			&nbsp; #fastcgi_pass&nbsp; unix:/tmp/php-cgi.sock;</li><li>			&nbsp; fastcgi_pass&nbsp; 127.0.0.1:9000;</li><li>&nbsp; fastcgi_index index.php;</li><li>			&nbsp; include fcgi.conf;&nbsp; &nbsp; &nbsp; </li><li>&nbsp; &nbsp; &nbsp;}</li><li>&nbsp;</li><li>		&nbsp; &nbsp; &nbsp;location /ucenter/data/avatar {</li><li>log_not_found off;</li><li>			access_log&nbsp; &nbsp;off;</li><li>			location ~ /(.*)_big\\\\.jpg$ {</li><li>			&nbsp; &nbsp; error_page 404 /ucenter/images/noavatar_big.gif;</li><li>			}</li><li>			location ~ /(.*)_middle\\\\.jpg$ {</li><li>			&nbsp; &nbsp; error_page 404 /ucenter/images/noavatar_middle.gif;</li><li>			}</li><li>			location ~ /(.*)_small\\\\.jpg$ {</li><li>			&nbsp; &nbsp; error_page 404 /ucenter/images/noavatar_small.gif;</li><li>			}</li><li>			 expires 300;</li><li>			 break;</li><li>		&nbsp; &nbsp; &nbsp;}</li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</li><p><strong>jspace rewrite</strong></p>&lt;div class=\"\\\" hl-surround\\=\"\"&gt;&lt;ol class=\\\"hl-main ln-show\\\" title=\\\"Double click to hide line number.\\\"&gt;&lt;li class=\"\\\" hl-firstline\\=\"\"&gt;location ~ .*\\\\.php?$ <li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; { </li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#fastcgi_pass&nbsp; unix:/tmp/php-cgi.sock; </li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;fastcgi_pass&nbsp; 127.0.0.1:9000; </li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;fastcgi_index index.php; </li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;include fcgi.conf;&nbsp; &nbsp; &nbsp; </li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } </li><li>&nbsp; </li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; location ~* ^/index.php/ </li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; { </li><li>&nbsp;&nbsp; &nbsp;rewrite ^/index.php/(.*) /index.php?$1 break; </li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;fastcgi_pass&nbsp; 127.0.0.1:9000; </li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;fastcgi_index index.php; </li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;include fcgi.conf; </li><li>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</li>'),(48,'777<img src=\"/data/upload/day_100305/201003051734277266.gif\" /><img src=\"/data/upload/day_100305/201003051734315116.gif\" /><img src=\"/data/upload/day_100305/201003051734352198.gif\" /><img src=\"/data/upload/day_100305/201003051734409337.gif\" /><img src=\"/data/upload/day_100305/201003051734444529.gif\" /><a href=\"/data/upload/day_100305/201003051734554359.txt\">点击打开链接</a><a href=\"/data/upload/day_100305/201003051735017261.txt\">点击打开链接</a>'),(59,'[code=php]<br />//如果PHP开启了魔法转移则自动去除转义<br />if (get_magic_quotes_gpc()) {<br />    fix_input_quotes();<br />}<br />[/code]<br />'),(60,'eeeeeeeeeeeeeeeee'),(61,'[code=php]<br />    function flush()<br />    {<br />        $this-&gt;last_result = null;<br />        $this-&gt;last_query = null;<br />        $this-&gt;query_start = null;<br />        $this-&gt;col_info = null;<br />    }<br /><br />    function get_page_results($query=null)<br />    {<br />        $query = preg_replace(\"/\\n|\\n\\r|\\s/\", \" \", $query);<br />        preg_match(\"~select(.*?) from (.*) limit ~ims\", $query, $m);<br />        //print_r($m);<br />        $total_query = \"SELECT COUNT(*) FROM {$m[2]}\";<br />        $this-&gt;num_rows_all = $this-&gt;get_var($total_query,$x=0,$y=0);<br />        $this-&gt;query($query);<br />    }<br />[/code]<br />'),(62,'[code=html]<br /># BEGIN Sablog-X<br />&lt;IfModule mod_rewrite.c&gt;<br />RewriteEngine On<br />RewriteBase /<br /><br />RewriteCond %{REQUEST_FILENAME} -f [OR]<br />RewriteCond %{REQUEST_FILENAME} -d<br />RewriteRule ^.*$ - [S=14]<br />[/code]<br />'),(63,'<p>ffffffffffffffffffffff</p><p>[code=html]<br />    function flush()<br />    {<br />        $this-&gt;last_result = null;<br />        $this-&gt;last_query = null;<br />        $this-&gt;query_start = null;<br />        $this-&gt;col_info = null;<br />    }<br /><br />    function get_page_results($query=null)<br />    {<br />        $query = preg_replace(\"/\\n|\\n\\r|\\s/\", \" \", $query);<br />        preg_match(\"~select(.*?) from (.*) limit ~ims\", $query, $m);<br />        //print_r($m);<br />        $total_query = \"SELECT COUNT(*) FROM {$m[2]}\";<br />        $this-&gt;num_rows_all = $this-&gt;get_var($total_query,$x=0,$y=0);<br />        $this-&gt;query($query);<br />    }<br />[/code]<br /></p>'),(64,'[code=php]<br />    function flush()<br />    {<br />        $this-&gt;last_result = null;<br />        $this-&gt;last_query = null;<br />        $this-&gt;query_start = null;<br />        $this-&gt;col_info = null;<br />    }<br /><br />    function get_page_results($query=null)<br />    {<br />        $query = preg_replace(\"/\\n|\\n\\r|\\s/\", \" \", $query);<br />        preg_match(\"~select(.*?) from (.*) limit ~ims\", $query, $m);<br />        //print_r($m);<br />        $total_query = \"SELECT COUNT(*) FROM {$m[2]}\";<br />        $this-&gt;num_rows_all = $this-&gt;get_var($total_query,$x=0,$y=0);<br />        $this-&gt;query($query);<br />    }<br />[/code]<br />'),(65,'[code=html]<br />ppp<br /><p>[/code]</p><p>[code=php]<br />oo<br />[/code]<br /></p>'),(66,'[code=php]<br />&lt;?php<br />    function flush()<br />    {<br />        $this-&gt;last_result = null;<br />        $this-&gt;last_query = null;<br />        $this-&gt;query_start = null;<br />        $this-&gt;col_info = null;<br />    }<br /><br />    function get_page_results($query=null)<br />    {<br />        $query = preg_replace(\"/\\n|\\n\\r|\\s/\", \" \", $query);<br />        preg_match(\"~select(.*?) from (.*) limit ~ims\", $query, $m);<br />        //print_r($m);<br />        $total_query = \"SELECT COUNT(*) FROM {$m[2]}\";<br />        $this-&gt;num_rows_all = $this-&gt;get_var($total_query,$x=0,$y=0);<br />        $this-&gt;query($query);<br />    }<br />?&gt;<br />[/code]<br />'),(67,'[code=plain]<br />&lt;?php<br />    function flush()<br />    {<br />        $this-&gt;last_result = null;<br />        $this-&gt;last_query = null;<br />        $this-&gt;query_start = null;<br />        $this-&gt;col_info = null;<br />    }<br /><br />    function get_page_results($query=null)<br />    {<br />        $query = preg_replace(\"/\\n|\\n\\r|\\s/\", \" \", $query);<br />        preg_match(\"~select(.*?) from (.*) limit ~ims\", $query, $m);<br />        //print_r($m);<br />        $total_query = \"SELECT COUNT(*) FROM {$m[2]}\";<br />        $this-&gt;num_rows_all = $this-&gt;get_var($total_query,$x=0,$y=0);<br />        $this-&gt;query($query);<br />    }<br />?&gt;<br />[/code]<br />'),(68,'[code=php]<br />class Amimal {<br />    function makeSound()<br />    {<br />        print \"Error: This methos should be re-implemented in the children\";<br />    }<br />}<br /><br />class Cat extends Animal {<br />    function makeSound()<br />    {<br />        print \"miau\";<br />    }<br />}<br /><br />class Dog extends Animal {<br />    function makeSound()<br />    {<br />        print \"wuff\";<br />    }<br />}<br /><br />function printTheRightSound($obj)<br />{<br />    if ($obj instanceof Animal) {<br />        $obj-&gt;makeSound();<br />    } else {<br />        print \"Error: Passed wrong kind of object\";<br />    }<br />    print \"\\n\";<br />}<br /><br />printTheRightSound(new Cat());<br /><br />printTheRightSound(new Dog());<br /><br />//结果是<br /><br />//miau<br /><br />//wuff<br />[/code]');

/*Table structure for table `sk_content_tag` */

DROP TABLE IF EXISTS `sk_content_tag`;

CREATE TABLE `sk_content_tag` (
  `content_id` int(10) unsigned NOT NULL,
  `tag_id` int(10) unsigned NOT NULL,
  PRIMARY KEY (`content_id`,`tag_id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

/*Data for the table `sk_content_tag` */

insert  into `sk_content_tag`(`content_id`,`tag_id`) values (41,72),(41,73);

/*Table structure for table `sk_tag` */

DROP TABLE IF EXISTS `sk_tag`;

CREATE TABLE `sk_tag` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name` char(40) NOT NULL,
  `count` int(10) unsigned NOT NULL DEFAULT '1',
  `hit` int(10) unsigned NOT NULL DEFAULT '0',
  PRIMARY KEY (`id`),
  UNIQUE KEY `name` (`name`)
) ENGINE=MyISAM AUTO_INCREMENT=76 DEFAULT CHARSET=utf8;

/*Data for the table `sk_tag` */

insert  into `sk_tag`(`id`,`name`,`count`,`hit`) values (64,'迪拜',0,0),(65,'媳妇',0,0),(66,'旅游',0,0),(67,'感慨',0,0),(68,'FireFox',0,0),(69,'wmode',0,0),(70,'MySQL',2,0),(71,'分析',0,0),(72,'nginx',1,0),(73,'rewrite',1,0),(74,'php',0,0),(75,'ls',0,0);

/*Table structure for table `sk_user` */

DROP TABLE IF EXISTS `sk_user`;

CREATE TABLE `sk_user` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `username` char(40) NOT NULL DEFAULT '',
  `password` char(40) NOT NULL DEFAULT '',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=4 DEFAULT CHARSET=utf8;

/*Data for the table `sk_user` */

insert  into `sk_user`(`id`,`username`,`password`) values (1,'chaobj','111111'),(2,'chaobj001','111111'),(3,'chaobj002','111111');

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
