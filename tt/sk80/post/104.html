<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="generator" content="blog.sk80.com" /><meta name="keywords" content="Linux网络备份MYSQL:Linux,MySQL linux 备份 " /><meta name="description" content="Linux网络备份MYSQL,彩色标签云,MySQL安装与配置" /><meta name="author" content="4kychao" /><link rel="stylesheet" type="text/css" href="http://sk2.com/templates/default/style.css" /><title>Linux网络备份MYSQL</title></head><body><div id="wrapper"><div id="header"><div id="header-inner"><p class="sitename">blog.sk80.com</p><div class="description">等我有钱了, 咱买棒棒糖, 买2 根, 1 根 你看着我吃, 另1根 我吃给你看。</div><div class="menu"><ul><li class="current_page"><a rel="nofollow" href="/">日志</a></li><!--li><a href="#">About</a></li--></ul></div></div></div><div id="wrapper-inner"><p id="topic-path"><a href="/" rel="nofollow">Home</a>&gt;<a href="http://sk2.com/category/linux/">Linux</a>&gt;<strong class="current">Linux网络备份MYSQL</strong></p><ul id="flip1" class="flip"><li class="newer"><a title="彩色标签云" href="http://sk2.com/post/105.html" rel="nofollow">Newer</a></li><li class="older"><a title="MySQL安装与配置" href="http://sk2.com/post/103.html" rel="nofollow">Older</a></li></ul><div id="detail"><div class="post"><h1>Linux网络备份MYSQL</h1><ul class="info"><li class="date">2010年 03月20日  18:06</li><li class="category"><a href="http://sk2.com/category/linux/">Linux</a></li></ul><div class="textbody">Linux网络备份MYSQL（精彩)<br />感谢原创作者：曹江华<br />转自：http://soft.yesky.com/os/lin/461/2164461.shtml<br /><br />笔者是一个中小Linux网站的管理员，系统构架是：RHEL&nbsp;4.0&nbsp;＋&nbsp;PHP&nbsp;4.3&nbsp;＋&nbsp;Mysql&nbsp;4.03&nbsp;＋Apache&nbsp;1.23。日均IP访问量在200次，一个典型的Linux小型网站。由于是小型网站，所以没有经费使用磁带机进行系统备份，使用的DVD光盘刻录机＋网络硬盘。随着Linux的应用日益广泛，特别是在网络应用方面，有大量的网络服务器使用Linux操作系统。由于Linux的桌面应用和Windows相比还有一定的差距，所以在企业应用中往往是Linux和Windows操作系统共存形成异构网络。在服务器端大多使用Linux和Unix的，PC端使用Windows&nbsp;9X/2000/XP。<br /><br /><br />一、	本地备份<br /><br />使用&nbsp;mysqldump进行备份非常简单，如果要备份数据库”&nbsp;phpbb_db_backup&nbsp;”,使用命令：<br />#mysqldump&nbsp;–u&nbsp;-p&nbsp;phpbb_db_backup&nbsp;&gt;&nbsp;/usr/backups/mysql/&nbsp;phpbb_db_backup.2005.5.6&nbsp;<br />还可以使用gzip命令对备份文件进行压缩：<br />#mysqldump&nbsp;phpbb_db_backup&nbsp;|&nbsp;gzip&nbsp;&gt;&nbsp;/usr/backups/mysql/&nbsp;phpbb_db_backup.2005.5.6。gz<br />恢复数据使用命令：<br />#mysql&nbsp;–u&nbsp;-p&nbsp;phpbb_db_backup&nbsp;<br />二、	备份数据到DVD盘片<br /><br />随着MYSQL数据量的增大，使用传统CD—R来备份硬盘并不现实，采用CD—RW分卷制作实在太麻烦、磁带机对于中小企业又过于昂贵。另外各个应用程序的复杂度日与剧增,&nbsp;处理的数据量也都相当庞大,Linux用户常常遇到的问题就是&nbsp;:&nbsp;有什么办法可以经济快捷的对数据做备份与保存。随着DVD刻录机和盘片的价格迅速降低，使用DVD刻录机用来备份Linux操作系统非常明智的。<br />1、安装<br />下面以IDE接口的内置刻录设备为例，介绍在Linux环境中使用DVD刻录机。Linux&nbsp;需要将IDE接口的刻录设备虚拟为SCSI设备才能进行DVD刻录。2.4以上内核Linux发行版本包含了已编译进内核的&nbsp;SCSI&nbsp;仿真，所以只要对启动文件作一些小改动；USB或1394(FireWire)接口的外置刻录机就简单多了。<br />把DVD刻录机设备接入计算机第二个IDE接口（dev/hdc），开启电源。假设系统用Grub启动，用文本编辑器打开/boot/grub/grub.conf，找到以“kernel”开头的一行，在这行内容的未尾加入“hdc=ide-scsi”，例如：“kernel&nbsp;/vmlinuz-2.4.20-8&nbsp;&nbsp;ro&nbsp;root=LABEL=/&nbsp;hdc=ide-scsi”。<br />2、安装刻录软件<br />DVD+RW-Tools&nbsp;：一个包含有用于刻录DVD和映像的软件工具包，包括：Growisofs和dvd+rw-format。官方站点：http://fy.chalmers.se/~appro/linux/DVD+RW/&nbsp;，&nbsp;<br />CDRDAO&nbsp;：DAO即是Disk-At-Once(实时刻录)，是一种在烧录过程中没有音轨间的两秒缓冲的刻录方法。它可以对磁盘的布局和磁道进行完全的控制，这一功能在刻录多来源的盘片相当有帮助。<br /><br />cdrtools：包含了一套用于CD、DVD刻录的工具。Growisofs在创建映像时会使用这个软件包中的mkisofs工具，并且用户可以使用readcd来从一个现有的DVD上创建ISO映像。此外，Cdrecord应用程序可被用于扫描连接系统上的CD／DVD刻录机，并且可以使用它来将ISO映像刻录到CD—R(W)光盘上。通常大多数Linux版本包括这个软件，也可以下载使用：http://freshmeat.net/redir/cdrecord/35795/url_homepage/cdrecord.html&nbsp;<br /><br />dvdrecord：命令行下的DVD刻录软件。命令行下的DVD刻录可用于很多种情形，比如当我们通过远程访问主机时，机器上的图形界面无法启动时，或者机器由于某些原因无法启动GUI时。此外，在完成一些备份等自动重复的功能时，也需要使用命令行工具。&nbsp;<br />以上介绍了一下必须的软件和相关下载网址，安装过程比较简单，这里就不赘述了。<br /><br />3、命令行下刻录<br /><br />使用DVD+RW-Tools&nbsp;进行刻录工作<br />growisofs是DVD+RW-Tools一个工具，Growlsofs访问其刻录设备使用的是一种不同的方式。它使用／dev下面的Unix路径来连接刻录机。不同的系统和发行版中用于刻录机的路径不尽相同，所以最好的方法是查看发行版中的帮助。在一些系统中，一个名为／dev／dvd的软链接会被设置成指向可用的DVD刻录机，在本文中，使用／dev／dvd来指定刻录机，如果系统中路径设置不同，那么请使用合适的路径将其取代。<br />（1）格式化可读写DVD光盘<br />可以使用DVD+RW-Tools工具包中提供的dvd十rw—format命令。它有两种格式化DVD光盘的方式：快速模式、完全模式。快速模式：<br />#dvd+rw-format&nbsp;-blank&nbsp;/dev/dvd<br />完全模式：<br />#dvd+rw-format&nbsp;-blank=full&nbsp;/dev/dvd<br /><br />(2)将文件存储至DVD刻录盘：<br />DVD和普通的光盘一样，使用的也是ISO9660文件系统，以及同样的通用扩展(Joliet和RockRidge)。Growlsofs提供了一种简单的将文件或目录存储至DVD刻录盘的方法。先用调用mkisofs工具来创建一个映像，并且无需在将该映像存储至硬盘之前就刻录下来。其基本的命令格式如下：<br />#growisofs&nbsp;-dvd-compat&nbsp;-Z&nbsp;/dev/dvd&nbsp;-J&nbsp;-R&nbsp;/path/to/home/cao<br />此命令将/path/to/home/cao目录下的文件制作一个映像并且刻录到的DVD光盘。<br /><br /><br />二、网络备份<br /><br />将MYSQL数据放在一台计算机上是不安全的，所以应当把数据备份到局域网中其他计算机中。假设Mysql服务器IP地址是：192.168.1.3。局域网使用Linux的远程计算机IP地址是192.168.1.17；局域网使用Windows的远程计算机IP地址是192.168.1.18。网络拓扑见图1.<br />&nbsp;<br />1.	通过NFS网络备份<br />类似于windows的网络共享，UNIX(Linux)系统也有自己的网络共享，那就是NFS(网络文件系统)，在linux客户端挂接(mount)NFS磁盘共享之前，必须先配置好NFS服务端。linux系统NFS服务端配置方法如下：<br />　　　(1)修改&nbsp;/etc/exports,增加共享目录<br />/export/home/sunky&nbsp;192.168.1.17(rw)<br />/export/home/sunky1&nbsp;*(rw)<br />/export/home/sunky2&nbsp;linux-client(rw)&nbsp;<br />　　　注：/export/home/目录下的sunky、sunky1、sunky2是准备共享的目录，10.140.133.23、*、linux-client是被允许挂接此共享linux客户机的IP地址或主机名。如果要使用主机名linux-client必须在服务端主机/etc/hosts文件里增加linux-client主机ip定义。格式如下：<br />　　　192.168.1.17&nbsp;linux-client<br />　　　若修改/etc/export文件增加新的共享，应先停止NFS服务，再启动NFS服务方能使新增加的共享起作用。使用命令exportfs&nbsp;-rv也可以达到同样的效果。linux客户端挂接(mount)其他linux系统或UNIX系统的NFS共享。这里我们假设192.168.1.17是NFS服务端的主机IP地址，当然这里也可以使用主机名，但必须在本机/etc/hosts文件里增加服务端ip定义。/export/home/sunky为服务端共享的目录。如此就可以在linux客户端通过/mnt/nfs来访问其它linux系统或UNIX系统以NFS方式共享出来的文件了。<br />把MYSQL数据备份到使用Linux的远程计算机需要在两端都安装NFS协议（Network&nbsp;File&nbsp;System），远程NFS计算机安装NFS协议后还要修改配置文件：/etc/exports,加入一行：<br />/usr/backups/mysql/&nbsp;192.168.1.17&nbsp;(rw,&nbsp;no_root_squash)<br />表示将/usr/backups/mysql/目录共享。这个目录具有远程root用户读写权限。保存NFS配置文件，然后使用命令：<br />#exportfs&nbsp;-a&nbsp;–r<br />然后重新启动NFS服务：<br />#service&nbsp;nfsd&nbsp;start<br />远程计算机设定后，在MYSQL服务器/mnt&nbsp;目录下建立一个backup_share目录：<br />#mkdir&nbsp;/mnt/backup_share<br />将远程的Linux计算机的/usr/backups/mysql/目录挂载到MYSQL服务器的/mnt/backup_share目录下：<br />#&nbsp;mount&nbsp;-t&nbsp;nfs&nbsp;192.168.1.17：/usr/backups/mysql&nbsp;/mnt/backup_share<br />将目录挂载进来后，只要进入/mnt/backup_share&nbsp;目录，就等于到了IP地址：192.168.1.7那部NFS&nbsp;计算机的/usr/backups/mysql&nbsp;目录中。下面使用mysqldump把“phpbb_db_backup”备份到远程计算机：<br />#&nbsp;mysqldump&nbsp;phpbb_db_backup&nbsp;&gt;&nbsp;/mnt/backup_share/&nbsp;phpbb_db_backup.2005-5-6<br /><br />2.	通过Samba网络备份<br />Windows网络共享的核心是SMB/CIFS，在linux下要挂接(mount)windows的磁盘共享，就必须安装和使用samba软件包。现在流行的linux发行版绝大多数已经包含了samba软件包，如果安装linux系统时未安装samba请首先安装samba。当然也可以到www.samba.org网站下载samba软件包，现在最新的版本是3.0.10版。然后Windows计算机上建立一个目录（/arc）并且共享，赋予其读写权限。同样在MYSQL服务器/mnt&nbsp;目录下建立一个backup_share1目录，然后进行挂载：<br />#&nbsp;mount&nbsp;-t&nbsp;smbfs&nbsp;-o&nbsp;username=cjh,&nbsp;password=XXXX&nbsp;//192.168.1.18/arc&nbsp;/mnt/backup_share<br />最后使用命令进行备份：<br />#&nbsp;mysqldump&nbsp;phpbb_db_backup&nbsp;&gt;&nbsp;/mnt/backup_share/&nbsp;phpbb_db_backup.2005-5-6</div><div class="entry-tags"><strong>Tags:</strong><a href="http://sk2.com/tag/MySQL/">MySQL</a>,<a href="http://sk2.com/tag/linux/">linux</a>,<a href="http://sk2.com/tag/备份/">备份</a></div></div><ul id="flip2" class="flip"><li>Newer:<a href="http://sk2.com/post/105.html">彩色标签云</a></li><li>Older:<a href="http://sk2.com/post/103.html">MySQL安装与配置</a></li></ul></div>
<div id="footer"><div><a rel="nofollow" class="admin" href="http://sk2.com/login"><small>ADMIN</small></a><address>&copy; 2010 <a href='http://sk2.com/'>blog.sk80.com</a></address></div></div></div></div><script type="text/javascript" src="http://sk2.com/include/js/resize.js"></script><script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">try {var pageTracker = _gat._getTracker("UA-5695529-2");pageTracker._trackPageview();} catch(err) {}</script></body></html>

<script language="javascript" type="text/javascript" src="http://js.users.51.la/3688801.js"></script>
<noscript><a href="http://www.51.la/?3688801" target="_blank"><img alt="&#x6211;&#x8981;&#x5566;&#x514D;&#x8D39;&#x7EDF;&#x8BA1;" src="http://img.users.51.la/3688801.asp" style="border:none" /></a></noscript>