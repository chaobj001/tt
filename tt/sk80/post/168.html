<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="generator" content="blog.sk80.com" /><meta name="keywords" content="SVN常用命令参考:Linux,svn " /><meta name="description" content="SVN常用命令参考,Python 学习资源,Mysql定时备份shell" /><meta name="author" content="4kychao" /><link rel="stylesheet" type="text/css" href="http://sk2.com/templates/default/style.css" /><title>SVN常用命令参考</title></head><body><div id="wrapper"><div id="header"><div id="header-inner"><p class="sitename">blog.sk80.com</p><div class="description">等我有钱了, 咱买棒棒糖, 买2 根, 1 根 你看着我吃, 另1根 我吃给你看。</div><div class="menu"><ul><li class="current_page"><a rel="nofollow" href="/">日志</a></li><!--li><a href="#">About</a></li--></ul></div></div></div><div id="wrapper-inner"><p id="topic-path"><a href="/" rel="nofollow">Home</a>&gt;<a href="http://sk2.com/category/linux/">Linux</a>&gt;<strong class="current">SVN常用命令参考</strong></p><ul id="flip1" class="flip"><li class="newer"><a title="Python 学习资源" href="http://sk2.com/post/169.html" rel="nofollow">Newer</a></li><li class="older"><a title="Mysql定时备份shell" href="http://sk2.com/post/167.html" rel="nofollow">Older</a></li></ul><div id="detail"><div class="post"><h1>SVN常用命令参考</h1><ul class="info"><li class="date">2010年 03月29日  18:39</li><li class="category"><a href="http://sk2.com/category/linux/">Linux</a></li></ul><div class="textbody"><div class="cnt"><div style="margin: 15px;" width="560"><div><p>svn命令通常都有帮助，如果你不知道命令怎么用，可以很方便获取帮助信息。比如有一个命令svn，但是不知道它有哪些子命令，可通过如下方式查询：</p><pre>$ svn help</pre><p>知道了子命令，但是不知道子命令的用法，还可以查询：</p><pre>$ svn help add</pre><p>另外，可能你需要设置svn commit的message编辑器，这可以通过定义环境变量SVN_EDITOR或者VISUAL或者EDITOR处理，比如：</p><pre>$ export SVN_EDITOR=/bin/vi</pre><p>本文以https来存取版本库，其他方式(比如file:///, svn://, http://, svn+ssh://等)操作基本是一样的。</p><p><strong>开发人员常用命令</strong></p><p>(1) 导入项目</p><pre>$ cd ~/project<br />$ mkdir -p svntest/{trunk,branches,tags}<br />$ svn import svntest https://localhost/test/svntest --message "Start project"<br />...<br />$ rm -rf svntest</pre><p>我们新建一个项目svntest，在该项目下新建三个子目录：trunk，开发主干；branches，开发分支；tags，开发阶段性标签。然后导入到版本库test下，然后把svntest拿掉。</p><p>(2) 导出项目</p><pre>$ svn checkout https://localhost/test/svntest/trunk</pre><p>修订版本号的指定方式是每个开发人员必须了解的，以下是几个参考例子，说明可参考svn推荐书。</p><pre>$ svn diff --revision PREV:COMMITTED foo.c<br /># shows the last change committed to foo.c<br /><br />$ svn log --revision HEAD<br /># shows log message for the latest repository commit<br /><br />$ svn diff --revision HEAD<br /># compares your working file (with local changes) to the latest version<br /># in the repository<br /><br />$ svn diff --revision BASE:HEAD foo.c<br /># compares your “pristine” foo.c (no local changes) with the <br /># latest version in the repository<br /><br />$ svn log --revision BASE:HEAD<br /># shows all commit logs since you last updated<br /><br />$ svn update --revision PREV foo.c<br /># rewinds the last change on foo.c<br /># (foo.c's working revision is decreased)<br /><br />$ svn checkout --revision 3<br /># specified with revision number<br /><br />$ svn checkout --revision {2002-02-17}<br />$ svn checkout --revision {15:30}<br />$ svn checkout --revision {15:30:00.200000}<br />$ svn checkout --revision {"2002-02-17 15:30"}<br />$ svn checkout --revision {"2002-02-17 15:30 +0230"}<br />$ svn checkout --revision {2002-02-17T15:30}<br />$ svn checkout --revision {2002-02-17T15:30Z}<br />$ svn checkout --revision {2002-02-17T15:30-04:00}<br />$ svn checkout --revision {20020217T1530}<br />$ svn checkout --revision {20020217T1530Z}<br />$ svn checkout --revision {20020217T1530-0500}</pre><p>(3) 日常指令</p><pre>$ svn update<br /><br />$ svn add foo.file<br />$ svn add foo1.dir<br />$ svn add foo2.dir --non-recursive<br />$ svn delete README<br />$ svn copy foo bar<br />$ svn move foo1 bar1<br /><br />$ svn status<br />$ svn status --verbose<br />$ svn status --verbose --show-updates<br />$ svn status stuff/fox.c<br /><br />$ svn diff<br />$ svn diff &gt; patchfile<br /><br />$ svn revert README<br />$ svn revert</pre><p>修改冲突发生时，会生成三个文件：.mine, .rOLDREV, .rNEWREV。比如：</p><pre>$ ls -l<br />sandwich.txt<br />sandwich.txt.mine<br />sandwich.txt.r1<br />sandwich.txt.r2</pre><p>解决修改冲突方式之一：修改冲突的文件sandwich.txt，然后运行命令：</p><pre>$ svn resolved sandwich.txt</pre><p>方式之二：用库里的新版本覆盖你的修改：</p><pre>$ cp sandwich.txt.r2 sandwich.txt<br />$ svn resolved sandwich.txt</pre><p>方式之三：撤销你的修改，这种方式不需要运行resolved子命令:</p><pre>$ svn revert sandwich.txt<br />Reverted 'sandwich.txt'<br />$ ls sandwich.*<br />sandwich.txt</pre><p>确保没问题后，就可以提交了。</p><pre>$ svn commit --message "Correct some fatal problems"<br />$ svn commit --file logmsg<br />$ svn commit</pre><p>(4) 检验版本历史</p><pre>$ svn log<br />$ svn log --revision 5:19<br />$ svn log foo.c<br />$ svn log -r 8 -v<br /><br />$ svn diff<br />$ svn diff --revision 3 rules.txt <br />$ svn diff --revision 2:3 rules.txt <br />$ svn diff --revision 4:5 http://svn.red-bean.com/repos/example/trunk/text/rules.txt<br /><br />$ svn cat --revision 2 rules.txt <br />$ svn cat --revision 2 rules.txt &gt; rules.txt.v2<br /><br />$ svn list http://svn.collab.net/repos/svn<br />$ svn list --verbose http://svn.collab.net/repos/svn<br /><br />$ svn checkout --revision 1729 # Checks out a new working copy at r1729<br />…<br />$ svn update --revision 1729 # Updates an existing working copy to r1729<br />…</pre><p>(5) 其他有用的命令</p><pre>svn cleanup</pre><p>为失败的事务清场。</p><p>(6) 分支和合并</p><p>建立分支方法一：先checkout然后做拷贝，最后提交拷贝。</p><pre>$ svn checkout http://svn.example.com/repos/calc bigwc<br />A  bigwc/trunk/<br />A  bigwc/trunk/Makefile<br />A  bigwc/trunk/integer.c<br />A  bigwc/trunk/button.c<br />A  bigwc/branches/<br />Checked out revision 340.<br /><br />$ cd bigwc<br />$ svn copy trunk branches/my-calc-branch<br />$ svn status<br />A  +   branches/my-calc-branch<br /><br />$ svn commit -m "Creating a private branch of /calc/trunk."<br />Adding         branches/my-calc-branch<br />Committed revision 341.</pre><p>建立分支方法二：直接远程拷贝。</p><pre>$ svn copy http://svn.example.com/repos/calc/trunk \<br />           http://svn.example.com/repos/calc/branches/my-calc-branch \<br />      -m "Creating a private branch of /calc/trunk."<br /><br />Committed revision 341.</pre><p>建立分支后，你可以把分支checkout并继续你的开发。</p><pre>$ svn checkout http://svn.example.com/repos/calc/branches/my-calc-branch</pre><p>假设你已经checkout了主干，现在想切换到某个分支开发，可做如下的操作：</p><pre>$ cd calc<br />$ svn info | grep URL<br />URL: http://svn.example.com/repos/calc/trunk<br />$ svn switch http://svn.example.com/repos/calc/branches/my-calc-branch<br />U   integer.c<br />U   button.c<br />U   Makefile<br />Updated to revision 341.<br />$ svn info | grep URL<br />URL: http://svn.example.com/repos/calc/branches/my-calc-branch</pre><p>合并文件的命令参考：</p><pre>$ svn diff -r 343:344 http://svn.example.com/repos/calc/trunk<br />$ svn merge -r 343:344 http://svn.example.com/repos/calc/trunk<br />$ svn commit -m "integer.c: ported r344 (spelling fixes) from trunk."<br />$ svn merge -r 343:344 http://svn.example.com/repos/calc/trunk my-calc-branch<br />$ svn merge http://svn.example.com/repos/branch1@150 \<br />            http://svn.example.com/repos/branch2@212 \<br />            my-working-copy<br />$ svn merge -r 100:200 http://svn.example.com/repos/trunk my-working-copy<br />$ svn merge -r 100:200 http://svn.example.com/repos/trunk<br />$ svn merge --dry-run -r 343:344 http://svn.example.com/repos/calc/trunk</pre><p>最后一条命令仅仅做合并测试，并不执行合并操作。</p><p>建立标签和建立分支没什么区别，不过是拷贝到不同的目录而已。</p><pre>$ svn copy http://svn.example.com/repos/calc/trunk \<br />           http://svn.example.com/repos/calc/tags/release-1.0 \<br />      -m "Tagging the 1.0 release of the 'calc' project."<br /><br />$ ls<br />my-working-copy/<br />$ svn copy my-working-copy http://svn.example.com/repos/calc/tags/mytag<br />Committed revision 352.</pre><p>后一种方式直接把本地的工作拷贝复制为标签。</p><p>此外，你还可以删除某个分支。</p><pre>$ svn delete http://svn.example.com/repos/calc/branches/my-calc-branch \<br />	-m "Removing obsolete branch of calc project."</pre><p><strong>管理人员常用命令</strong></p><p>(7) 版本库管理</p><pre>$ svnadmin help<br />...<br />$ svnadmin help create<br />...<br />$ svnadmin create --fs-type bdb /usr/local/repository/svn/test<br />$ chown -R svn.svn /usr/local/repository/svn/test</pre><p>建立版本库，库类型为bdb（使用Berkeley DB做仓库），库名称为test。<br />svn版本库有两种存储方式：基于Berkeley DB(bdb)或者基于文件系统(fsfs)，通过 --fs-type可指定存储方式。</p><p>(8) 查询版本库信息</p><pre>$ svnlook help<br />...<br />$ svnlook help tree<br />...<br />$ svnlook tree /usr/local/repository/svn/test --show-ids<br />...</pre><p>更详细的命令，请参考SVN官方推荐的书(http://svnbook.red-bean.com/)。这本书有中译版，而且是免费的。</p><p>本文引用通告地址：<a href="http://wxy8893.spaces.eepw.com.cn/articles/article/item/20961#">http://wxy8893.spaces.eepw.com.cn/articles/trackback/item/20961</a></p></div></div></div></div><div class="entry-tags"><strong>Tags:</strong><a href="http://sk2.com/tag/svn/">svn</a></div></div><ul id="flip2" class="flip"><li>Newer:<a href="http://sk2.com/post/169.html">Python 学习资源</a></li><li>Older:<a href="http://sk2.com/post/167.html">Mysql定时备份shell</a></li></ul></div>
<div id="footer"><div><a rel="nofollow" class="admin" href="http://sk2.com/login"><small>ADMIN</small></a><address>&copy; 2010 <a href='http://sk2.com/'>blog.sk80.com</a></address></div></div></div></div><script type="text/javascript" src="http://sk2.com/include/js/resize.js"></script><script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">try {var pageTracker = _gat._getTracker("UA-5695529-2");pageTracker._trackPageview();} catch(err) {}</script></body></html>

<script language="javascript" type="text/javascript" src="http://js.users.51.la/3688801.js"></script>
<noscript><a href="http://www.51.la/?3688801" target="_blank"><img alt="&#x6211;&#x8981;&#x5566;&#x514D;&#x8D39;&#x7EDF;&#x8BA1;" src="http://img.users.51.la/3688801.asp" style="border:none" /></a></noscript>