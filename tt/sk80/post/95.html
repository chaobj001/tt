<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="generator" content="blog.sk80.com" /><meta name="keywords" content="Linux网络备份MYSQL:Mysql,MySQL linux " /><meta name="description" content="Linux网络备份MYSQL,mysql的初级使用,MySQL索引分析和优化" /><meta name="author" content="4kychao" /><link rel="stylesheet" type="text/css" href="http://sk2.com/templates/default/style.css" /><title>Linux网络备份MYSQL</title></head><body><div id="wrapper"><div id="header"><div id="header-inner"><p class="sitename">blog.sk80.com</p><div class="description">等我有钱了, 咱买棒棒糖, 买2 根, 1 根 你看着我吃, 另1根 我吃给你看。</div><div class="menu"><ul><li class="current_page"><a rel="nofollow" href="/">日志</a></li><!--li><a href="#">About</a></li--></ul></div></div></div><div id="wrapper-inner"><p id="topic-path"><a href="/" rel="nofollow">Home</a>&gt;<a href="http://sk2.com/category/mysql/">Mysql</a>&gt;<strong class="current">Linux网络备份MYSQL</strong></p><ul id="flip1" class="flip"><li class="newer"><a title="mysql的初级使用" href="http://sk2.com/post/96.html" rel="nofollow">Newer</a></li><li class="older"><a title="MySQL索引分析和优化" href="http://sk2.com/post/94.html" rel="nofollow">Older</a></li></ul><div id="detail"><div class="post"><h1>Linux网络备份MYSQL</h1><ul class="info"><li class="date">2010年 03月20日  15:23</li><li class="category"><a href="http://sk2.com/category/mysql/">Mysql</a></li></ul><div class="textbody">一、&nbsp; &nbsp; &nbsp; &nbsp; 本地备份<br /><br />使用 <span href="http://bbs.chinaunix.net/tag.php?name=mysql" class="t_tag">mysql</span>dump进行备份非常简单，如果要备份数据库” <span href="http://bbs.chinaunix.net/tag.php?name=php" class="t_tag">php</span>bb_db_backup ”,使用<span href="http://bbs.chinaunix.net/tag.php?name=%C3%FC%C1%EE" class="t_tag">命令</span>：<br />#mysqldump –u -p phpbb_db_backup &gt; /usr/backups/mysql/ phpbb_db_backup.2005.5.6 <br />还可以使用gzip命令对备份文件进行压缩：<br />#mysqldump phpbb_db_backup | gzip &gt; /usr/backups/mysql/ phpbb_db_backup.2005.5.6。gz<br />恢复数据使用命令：<br />#mysql –u -p phpbb_db_backup <br />二、&nbsp; &nbsp; &nbsp; &nbsp; 备份数据到DVD盘片<br /><br />随着MYSQL数据量的增大，使用传统CD—R来备份硬盘并不现实，采用CD—RW分卷制作实在太麻烦、磁带机对于中小企业又过于昂贵。另外各个应用程序的复杂度日与剧增, 处理的数据量也都相当庞大,Linux用户常常遇到的问题就是 : 有什么办法可以经济快捷的对数据做备份与保存。随着DVD刻录机和盘片的价格迅速降低，使用DVD刻录机用来备份Linux操作系统非常明智的。<br />1、安装<br />下面以IDE接口的内置刻录设备为例，介绍在Linux环境中使用DVD刻录机。Linux 需要将IDE接口的刻录设备虚拟为SCSI设备才能进行DVD刻录。2.4以上内核Linux发行版本包含了已编译进内核的 SCSI 仿真，所以只要对启动文件作一些小改动；USB或1394(FireWire)接口的外置刻录机就简单多了。<br />把DVD刻录机设备接入计算机第二个IDE接口（dev/hdc），开启<span href="http://bbs.chinaunix.net/tag.php?name=%B5%E7%D4%B4" class="t_tag">电源</span>。假设系统用Grub启动，用文本编辑器打开/boot/grub/grub.conf，找到以“kernel”开头的一行，在这行内容的未尾加入“hdc=ide-scsi”，例如：“kernel /vmlinuz-2.4.20-8&nbsp;&nbsp;ro root=LABEL=/ hdc=ide-scsi”。<br />2、安装刻录<span href="http://bbs.chinaunix.net/tag.php?name=%C8%ED%BC%FE" class="t_tag">软件</span><br />DVD+RW-Tools ：一个包含有用于刻录DVD和映像的软件工具包，包括：Growisofs和dvd+rw-format。官方站点：<a href="http://fy.chalmers.se/%7Eappro/linux/DVD+RW/" target="_blank">http://fy.chalmers.se/~appro/<span href="http://bbs.chinaunix.net/tag.php?name=linux" class="t_tag">linux</span>/DVD+RW/</a> ， <br />CDRDAO ：DAO即是Disk-At-Once(实时刻录)，是一种在烧录过程中没有音轨间的两秒缓冲的刻录方法。它可以对磁盘的布局和磁道进行完全的控制，这一功能在刻录多来源的盘片相当有帮助。<br /><br />cdrtools：包含了一套用于CD、DVD刻录的工具。Growisofs在创建映像时会使用这个软件包中的mkisofs工具，并且用户可以使用readcd来从一个现有的DVD上创建ISO映像。此外，Cdrecord应用程序可被用于扫描连接系统上的CD／DVD刻录机，并且可以使用它来将ISO映像刻录到CD—R(W)光盘上。通常大多数Linux版本包括这个软件，也可以<span href="http://bbs.chinaunix.net/tag.php?name=%CF%C2%D4%D8" class="t_tag">下载</span>使用：<a href="http://freshmeat.net/redir/cdrecord/35795/url_homepage/cdrecord.html" target="_blank">http://freshmeat.net/redir/cdrec ... epage/cdrecord.html</a> <br /><br />dvdrecord：命令行下的DVD刻录软件。命令行下的DVD刻录可用于很多种情形，比如当我们通过远程访问主机时，机器上的图形界面无法启动时，或者机器由于某些原因无法启动GUI时。此外，在完成一些备份等自动重复的功能时，也需要使用命令行工具。 <br />以上介绍了一下必须的软件和相关下载网址，安装过程比较简单，这里就不赘述了。<br /><br />3、命令行下刻录<br /><br />使用DVD+RW-Tools 进行刻录<span href="http://bbs.chinaunix.net/tag.php?name=%B9%A4%D7%F7" class="t_tag">工作</span><br />growisofs是DVD+RW-Tools一个工具，Growlsofs访问其刻录设备使用的是一种不同的方式。它使用／dev下面的Unix路径来连接刻录机。不同的系统和发行版中用于刻录机的路径不尽相同，所以最好的方法是查看发行版中的帮助。在一些系统中，一个名为／dev／dvd的软链接会被设置成指向可用的DVD刻录机，在本文中，使用／dev／dvd来指定刻录机，如果系统中路径设置不同，那么请使用合适的路径将其取代。<br />（1）格式化可读写DVD光盘<br />可以使用DVD+RW-Tools工具包中提供的dvd十rw—format命令。它有两种格式化DVD光盘的方式：快速<span href="http://bbs.chinaunix.net/tag.php?name=%C4%A3%CA%BD" class="t_tag">模式</span>、完全模式。快速模式：<br />#dvd+rw-format -blank /dev/dvd<br />完全模式：<br />#dvd+rw-format -blank=full /dev/dvd<br /><br />(2)将文件<span href="http://bbs.chinaunix.net/tag.php?name=%B4%E6%B4%A2" class="t_tag">存储</span>至DVD刻录盘：<br />DVD和普通的光盘一样，使用的也是ISO9660文件系统，以及同样的通用扩展(Joliet和RockRidge)。Growlsofs提供了一种简单的将文件或目录存储至DVD刻录盘的方法。先用调用mkisofs工具来创建一个映像，并且无需在将该映像存储至硬盘之前就刻录下来。其基本的命令格式如下：<br />#growisofs -dvd-compat -Z /dev/dvd -J -R /path/to/home/cao<br />此命令将/path/to/home/cao目录下的文件制作一个映像并且刻录到的DVD光盘。<br /><br /><br />二、网络备份<br /><br />将MYSQL数据放在一台计算机上是不安全的，所以应当把数据备份到局域网中其他计算机中。假设Mysql服务器IP地址是：192.168.1.3。局域网使用Linux的远程计算机IP地址是192.168.1.17；局域网使用Windows的远程计算机IP地址是192.168.1.18。网络拓扑见图1.<br /> <br />1.&nbsp; &nbsp; &nbsp; &nbsp; 通过NFS网络备份<br />类似于windows的网络共享，UNIX(Linux)系统也有自己的网络共享，那就是NFS(网络文件系统)，在linux客户端挂接(mount)NFS磁盘共享之前，必须先配置好NFS服务端。linux系统NFS服务端配置方法如下：<br />　　　(1)修改 /etc/exports,增加共享目录<br />/export/home/sunky 192.168.1.17(rw)<br />/export/home/sunky1 *(rw)<br />/export/home/sunky2 linux-client(rw) <br />　　　注：/export/home/目录下的sunky、sunky1、sunky2是准备共享的目录，10.140.133.23、*、linux-client是被允许挂接此共享linux客户机的IP地址或主机名。如果要使用主机名linux-client必须在服务端主机/etc/hosts文件里增加linux-client主机ip定义。格式如下：<br />　　　192.168.1.17 linux-client<br />　　　若修改/etc/export文件增加新的共享，应先停止NFS服务，再启动NFS服务方能使新增加的共享起作用。使用命令exportfs -rv也可以达到同样的效果。linux客户端挂接(mount)其他linux系统或UNIX系统的NFS共享。这里我们假设192.168.1.17是NFS服务端的主机IP地址，当然这里也可以使用主机名，但必须在本机/etc/hosts文件里增加服务端ip定义。/export/home/sunky为服务端共享的目录。如此就可以在linux客户端通过/mnt/nfs来访问其它linux系统或UNIX系统以NFS方式共享出来的文件了。<br />把MYSQL数据备份到使用Linux的远程计算机需要在两端都安装NFS协议（Network File System），远程NFS计算机安装NFS协议后还要修改配置文件：/etc/exports,加入一行：<br />/usr/backups/mysql/ 192.168.1.17 (rw, no_root_squash)<br />表示将/usr/backups/mysql/目录共享。这个目录具有远程root用户读写权限。保存NFS配置文件，然后使用命令：<br />#exportfs -a –r<br />然后重新启动NFS服务：<br />#service nfsd start<br />远程计算机设定后，在MYSQL服务器/mnt 目录下建立一个backup_share目录：<br />#mkdir /mnt/backup_share<br />将远程的Linux计算机的/usr/backups/mysql/目录挂载到MYSQL服务器的/mnt/backup_share目录下：<br /># mount -t nfs 192.168.1.17：/usr/backups/mysql /mnt/backup_share<br />将目录挂载进来后，只要进入/mnt/backup_share 目录，就等于到了IP地址：192.168.1.7那部NFS 计算机的/usr/backups/mysql 目录中。下面使用mysqldump把“phpbb_db_backup”备份到远程计算机：<br /># mysqldump phpbb_db_backup &gt; /mnt/backup_share/ phpbb_db_backup.2005-5-6<br /><br />2.&nbsp; &nbsp; &nbsp; &nbsp; 通过Samba网络备份<br />Windows网络共享的核心是SMB/CIFS，在linux下要挂接(mount)windows的磁盘共享，就必须安装和使用samba软件包。现在流行的linux发行版绝大多数已经包含了samba软件包，如果安装linux系统时未安装samba请首先安装samba。当然也可以到<a href="http://www.samba.org/" target="_blank">www.samba.org</a>网站下载samba软件包，现在最新的版本是3.0.10版。然后Windows计算机上建立一个目录（/arc）并且共享，赋予其读写权限。同样在MYSQL服务器/mnt 目录下建立一个backup_share1目录，然后进行挂载：<br /># mount -t smbfs -o username=cjh, password=XXXX //192.168.1.18/arc /mnt/backup_share<br />最后使用命令进行备份：<br /># mysqldump phpbb_db_backup &gt; /mnt/backup_share/ phpbb_db_backup.2005-5-6</div><div class="entry-tags"><strong>Tags:</strong><a href="http://sk2.com/tag/MySQL/">MySQL</a>,<a href="http://sk2.com/tag/linux/">linux</a></div></div><ul id="flip2" class="flip"><li>Newer:<a href="http://sk2.com/post/96.html">mysql的初级使用</a></li><li>Older:<a href="http://sk2.com/post/94.html">MySQL索引分析和优化</a></li></ul></div>
<div id="footer"><div><a rel="nofollow" class="admin" href="http://sk2.com/login"><small>ADMIN</small></a><address>&copy; 2010 <a href='http://sk2.com/'>blog.sk80.com</a></address></div></div></div></div><script type="text/javascript" src="http://sk2.com/include/js/resize.js"></script><script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">try {var pageTracker = _gat._getTracker("UA-5695529-2");pageTracker._trackPageview();} catch(err) {}</script></body></html>

<script language="javascript" type="text/javascript" src="http://js.users.51.la/3688801.js"></script>
<noscript><a href="http://www.51.la/?3688801" target="_blank"><img alt="&#x6211;&#x8981;&#x5566;&#x514D;&#x8D39;&#x7EDF;&#x8BA1;" src="http://img.users.51.la/3688801.asp" style="border:none" /></a></noscript>