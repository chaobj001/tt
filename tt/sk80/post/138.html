<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="generator" content="blog.sk80.com" /><meta name="keywords" content="crontab定时任务的用法:Linux,linux crontab " /><meta name="description" content="crontab定时任务的用法,正则替换字符串,怀旧经典电视剧主题曲" /><meta name="author" content="4kychao" /><link rel="stylesheet" type="text/css" href="http://sk2.com/templates/default/style.css" /><title>crontab定时任务的用法</title></head><body><div id="wrapper"><div id="header"><div id="header-inner"><p class="sitename">blog.sk80.com</p><div class="description">等我有钱了, 咱买棒棒糖, 买2 根, 1 根 你看着我吃, 另1根 我吃给你看。</div><div class="menu"><ul><li class="current_page"><a rel="nofollow" href="/">日志</a></li><!--li><a href="#">About</a></li--></ul></div></div></div><div id="wrapper-inner"><p id="topic-path"><a href="/" rel="nofollow">Home</a>&gt;<a href="http://sk2.com/category/linux/">Linux</a>&gt;<strong class="current">crontab定时任务的用法</strong></p><ul id="flip1" class="flip"><li class="newer"><a title="正则替换字符串" href="http://sk2.com/post/139.html" rel="nofollow">Newer</a></li><li class="older"><a title="怀旧经典电视剧主题曲" href="http://sk2.com/post/137.html" rel="nofollow">Older</a></li></ul><div id="detail"><div class="post"><h1>crontab定时任务的用法</h1><ul class="info"><li class="date">2010年 03月26日  15:21</li><li class="category"><a href="http://sk2.com/category/linux/">Linux</a></li></ul><div class="textbody">crontab task 格式<br /><br />* * * * * task<br />分 时 日 月 周 task<br /><br />第1列分钟1～5 9  (0表示0分)<br />第2列 小时1～2 3（0表示子夜）<br />第3列 日1～3 1   <br />第4列 月1～1 2  <br />第5列 星期0～6（0表示星期天）<br />第6列 要运行的命令<br /><br />一些例子:<br />30 21* * * /apps/bin/cleanup.sh<br />上面的例子表示每晚的2 1 : 3 0运行/ a p p s / b i n目录下的c l e a n u p . s h。<br />45 4 1,10,22 * * /apps/bin/backup.sh<br />上面的例子表示每月1、1 0、2 2日的4 : 4 5运行/ a p p s / b i n目录下的b a c k u p . s h。<br />10 1 * * 6,0 /bin/find -name "core" -exec rm {} \;<br />上面的例子表示每周六、周日的1 : 1 0运行一个f i n d命令。<br />0,30 18-23 * * * /apps/bin/dbcheck.sh<br />上面的例子表示在每天1 8 : 0 0至2 3 : 0 0之间每隔3 0分钟运行/ a p p s / b i n目录下的d b c h e c k . s h。<br />0 23 * * 6 /apps/bin/qtrend.sh<br />上面的例子表示每星期六的11 : 0 0 p m运行/ a p p s / b i n目录下的q t r e n d . s h<br /><br />实现定时task的两种方式<br />一种是编辑一个文件,用crontab 载入<br />一种是用crontab -e 直接编辑生效<br /><br />我自己一个例子<br /><br />每隔以一分钟往一个文件打入一堆字符<br />先vi crontab1<br />#every minute echo char to file<br />1-59 * * * * echo `date`" lj\n" &gt;&gt; /opt/lijie/lj.txt<br />最好加上注释<br />这样就能明确当前的这个定时任务的目的<br />然后 crontab crontab1载入crontab1这个定时任务<br /><br /> <br /><br />另外一种是<br />crontab -e<br />#every minute echo char to file<br />1-59 * * * * echo `date`" lj\n" &gt;&gt; /opt/lijie/lj.txt<br /><br />date 用单引号,是表示如果date是一个命令,就作为命令执行<br />如果你直接用date ,那么输出的是"date"这个字符串,而不是date这个命令的执行结果<br /><br />&gt;&gt; 是附加到文件末尾,而&gt;是直接覆盖文件<br /><br />如果crontab -e无法编辑<br />那么是你的环境变量没有配置<br />请你进入 vi /etc/profile<br />加上<br />EDITOR=vi<br />export EDITOR<br /><br />crontab -l 列出所有定时任务<br /><br />如果要删除一个定时任务<br />那么<br />crontab -e<br />注释掉对应定时任务语句<br />例如要删除我刚刚定义的那个定时任务<br />#every minute echo char to file<br /> 1-59 * * * * echo `date`" lj\n" &gt;&gt; /opt/lijie/lj.txt<br />只需要<br />#every minute echo char to file<br />#1-59 * * * * echo `date`" lj\n" &gt;&gt; /opt/lijie/lj.txt<br /><br />如果用crontab -r<br />就删除拉所有的定时任务<br /><br />特别注意:<br />1, 如果用crontab 文件来载入定时任务,将会冲掉定时任务<br />所以如果要新增定时任务,最好就用crontab -e来新增定时任务<br />不要用crontab 文件。<br /><br />2, crontab的日志文件为 /var/log/cron<br /><br />3, 如果使用 crontab &lt;filename&gt; 来设置cron，一定要注意文件乱码的问题。我就碰到一个问题，/var/log/cron 日志里面显示 Dec 28 11:34:00 TARGET CROND[13449]: (hnuc) CMD (/home/hnuc/shell/t.sh^M) 后面的～M是乱码，原因是：我是使用editplus编辑的cron file，里面的回车换行符号是dos的而不是linux或者unix的。这里的^M 实际上是个dos的换行符，在linux环境下解析成这个了。<br /><br /></div><div class="entry-tags"><strong>Tags:</strong><a href="http://sk2.com/tag/linux/">linux</a>,<a href="http://sk2.com/tag/crontab/">crontab</a></div></div><ul id="flip2" class="flip"><li>Newer:<a href="http://sk2.com/post/139.html">正则替换字符串</a></li><li>Older:<a href="http://sk2.com/post/137.html">怀旧经典电视剧主题曲</a></li></ul></div>
<div id="footer"><div><a rel="nofollow" class="admin" href="http://sk2.com/login"><small>ADMIN</small></a><address>&copy; 2010 <a href='http://sk2.com/'>blog.sk80.com</a></address></div></div></div></div><script type="text/javascript" src="http://sk2.com/include/js/resize.js"></script><script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">try {var pageTracker = _gat._getTracker("UA-5695529-2");pageTracker._trackPageview();} catch(err) {}</script></body></html>

<script language="javascript" type="text/javascript" src="http://js.users.51.la/3688801.js"></script>
<noscript><a href="http://www.51.la/?3688801" target="_blank"><img alt="&#x6211;&#x8981;&#x5566;&#x514D;&#x8D39;&#x7EDF;&#x8BA1;" src="http://img.users.51.la/3688801.asp" style="border:none" /></a></noscript>