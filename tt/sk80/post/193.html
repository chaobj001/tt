<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="generator" content="blog.sk80.com" /><meta name="keywords" content="MySQL 优化编译:Mysql,优化 " /><meta name="description" content="MySQL 优化编译,使用Apache做负载均衡,VIM常用指令" /><meta name="author" content="4kychao" /><link rel="stylesheet" type="text/css" href="http://sk2.com/templates/default/style.css" /><title>MySQL 优化编译</title></head><body><div id="wrapper"><div id="header"><div id="header-inner"><p class="sitename">blog.sk80.com</p><div class="description">等我有钱了, 咱买棒棒糖, 买2 根, 1 根 你看着我吃, 另1根 我吃给你看。</div><div class="menu"><ul><li class="current_page"><a rel="nofollow" href="/">日志</a></li><!--li><a href="#">About</a></li--></ul></div></div></div><div id="wrapper-inner"><p id="topic-path"><a href="/" rel="nofollow">Home</a>&gt;<a href="http://sk2.com/category/mysql/">Mysql</a>&gt;<strong class="current">MySQL 优化编译</strong></p><ul id="flip1" class="flip"><li class="newer"><a title="使用Apache做负载均衡" href="http://sk2.com/post/194.html" rel="nofollow">Newer</a></li><li class="older"><a title="VIM常用指令" href="http://sk2.com/post/192.html" rel="nofollow">Older</a></li></ul><div id="detail"><div class="post"><h1>MySQL 优化编译</h1><ul class="info"><li class="date">2010年 04月10日  16:14</li><li class="category"><a href="http://sk2.com/category/mysql/">Mysql</a></li></ul><div class="textbody"><p>1. -static 13%   <br /> –with-client-ldflags=-all-static    <br /> –with-mysqld-ldflags=-all-static    <br />静态链接提高13%性能 </p><p></p><p>2. -pgcc 1%   <br />CFLAGS="-O3 -mpentiumpro -mstack-align-double" CXX=gcc \    <br />CXXFLAGS="-O3 -mpentiumpro -mstack-align-double \    <br />-felide-constructors -fno-exceptions -fno-rtti"    <br />如果是Intel处理器，使用pgcc提高1%性能 </p><p></p><p>3. Unix Socket 7.5%   <br />–with-unix-socket-path=/usr/local/mysql/tmp/mysql.sock    <br />使用unix套接字链接提高7.5%性能，所以在windows下mysql性能肯定不如unix下面 </p><p></p><p>4. –enable-assembler 允许使用汇编模式(优化性能) 下面是总体的编译文件   <br />编译代码    <br />/usr/sbin/groupadd mysql    <br />/usr/sbin/useradd -g mysql mysql    <br />tar zxvf mysql-5.0.45.tar.gz    <br />cd mysql-5.0.45    <br />CFLAGS="-O3" CXX=gcc CXXFLAGS="-O3 -felide-constructors -fno-exceptions -fno-rtti -fomit-frame-pointer -ffixed-ebp"&nbsp; <br />export CFLAGS CXX CXXFLAGS     <br />./configure –prefix=/usr/local/mysql –enable-assembler –with-mysqld-ldflags=-all-static&nbsp; –with-client-ldflags=-all-static&nbsp; –with-unix-socket-path=/tmp/mysql.sock&nbsp; –with-extra-charsets=gbk,gb2312,utf8,latin1&nbsp; –without-debug –with-pthread –enable-thread-safe-client&nbsp;&nbsp; –without-isam –with-innodb </p><p>make &amp;&amp; make install   <br />chmod +w /usr/local/webserver/mysql    <br />chown -R mysql:mysql /usr/local/webserver/mysql    <br />cp support-files/my-medium.cnf /usr/local/webserver/mysql/my.cnf </p><p>附：以下为附加步骤，如果你想在这台服务器上运行MySQL数据库，则执行以下两步。如果你只是希望让PHP支持 MySQL扩展库，能够连接其他服务器上的MySQL数据库，那么，以下两步无需执行。</p><p>1)、以mysql用户帐号的身份建立数据表：    <br />/usr/local/webserver/mysql/bin/mysql_install_db –defaults-file=/usr/local/webserver/mysql/my.cnf –basedir=/usr/local/webserver/mysql –datadir=/usr/local/webserver/mysql/data –user=mysql –pid-file=/usr/local/webserver/mysql/mysql.pid –skip-locking –port=3306 –socket=/tmp/mysql.sock </p><p></p><p>2)、启动MySQL（最后的&amp;表示在后台运行）   <br />/bin/sh /usr/local/webserver/mysql/bin/mysqld_safe –defaults-file=/usr/local/webserver/mysql/my.cnf &amp; </p><p></p># useradd mysql -g mysql -M -s /bin/false   <br /># ./configure –prefix=/web/mysql \ 指定安装目录    <br />–without-debug \去除debug模式    <br />–with-extra-charsets=gb2312 \添加gb2312中文字符支持    <br />–enable-assembler \使用一些字符函数的汇编版本    <br />–without-isam \去掉isam表类型支持 现在很少用了 isam表是一种依赖平台的表    <br />–without-innodb \去掉innodb表支持 innodb是一种支持事务处理的表,适合企业级应用    <br />–with-pthread \强制使用pthread库(posix线程库)    <br />–enable-thread-safe-client \以线程方式编译客户端    <br />–with-client-ldflags=-all-static \    <br />–with-mysqld-ldflags=-all-static \以纯静态方式编译服务端和客户端    <br />done!<br /></div><div class="entry-tags"><strong>Tags:</strong><a href="http://sk2.com/tag/优化/">优化</a></div></div><ul id="flip2" class="flip"><li>Newer:<a href="http://sk2.com/post/194.html">使用Apache做负载均衡</a></li><li>Older:<a href="http://sk2.com/post/192.html">VIM常用指令</a></li></ul></div>
<div id="footer"><div><a rel="nofollow" class="admin" href="http://sk2.com/login"><small>ADMIN</small></a><address>&copy; 2010 <a href='http://sk2.com/'>blog.sk80.com</a></address></div></div></div></div><script type="text/javascript" src="http://sk2.com/include/js/resize.js"></script><script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">try {var pageTracker = _gat._getTracker("UA-5695529-2");pageTracker._trackPageview();} catch(err) {}</script></body></html>

<script language="javascript" type="text/javascript" src="http://js.users.51.la/3688801.js"></script>
<noscript><a href="http://www.51.la/?3688801" target="_blank"><img alt="&#x6211;&#x8981;&#x5566;&#x514D;&#x8D39;&#x7EDF;&#x8BA1;" src="http://img.users.51.la/3688801.asp" style="border:none" /></a></noscript>