<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="generator" content="blog.sk80.com" /><meta name="keywords" content="Subversion在Linux下的安装与使用(和Apache配套使用):Linux,linux svn " /><meta name="description" content="Subversion在Linux下的安装与使用(和Apache配套使用),linux常用svn命令,MYSQL常用SQL命令（3）" /><meta name="author" content="4kychao" /><link rel="stylesheet" type="text/css" href="http://sk2.com/templates/default/style.css" /><title>Subversion在Linux下的安装与使用(和Apache配套使用)</title></head><body><div id="wrapper"><div id="header"><div id="header-inner"><p class="sitename">blog.sk80.com</p><div class="description">等我有钱了, 咱买棒棒糖, 买2 根, 1 根 你看着我吃, 另1根 我吃给你看。</div><div class="menu"><ul><li class="current_page"><a rel="nofollow" href="/">日志</a></li><!--li><a href="#">About</a></li--></ul></div></div></div><div id="wrapper-inner"><p id="topic-path"><a href="/" rel="nofollow">Home</a>&gt;<a href="http://sk2.com/category/linux/">Linux</a>&gt;<strong class="current">Subversion在Linux下的安装与使用(和Apache配套使用)</strong></p><ul id="flip1" class="flip"><li class="newer"><a title="linux常用svn命令" href="http://sk2.com/post/130.html" rel="nofollow">Newer</a></li><li class="older"><a title="MYSQL常用SQL命令（3）" href="http://sk2.com/post/128.html" rel="nofollow">Older</a></li></ul><div id="detail"><div class="post"><h1>Subversion在Linux下的安装与使用(和Apache配套使用)</h1><ul class="info"><li class="date">2010年 03月24日  00:46</li><li class="category"><a href="http://sk2.com/category/linux/">Linux</a></li></ul><div class="textbody"><p>/*********************************<br />Title:Subversion在linux下的安装与使用(和Apache配套使用)<br />Author:成刚&lt;<span style="color:#1f5ba4;">chenggang2008@foxmail.com</span>&gt;<br />Date:2008-7-8<br />Modify:2008-10-24<br />**********************************/<!--IWMS_AD_BEGIN--></p><table align="center" border="0" width="97%"><tbody><tr><td colspan="3"><div align="center"></div><br /></td></tr></tbody></table><!--IWMS_AD_END--><br /><p>安装机器: 192.168.2.180<br />操作系统: CentOS 5.2</p><br /><p>/program/apache/为服务器上的apache安装目录</p><br /><p><span style="color: rgb(102, 153, 0);"><span><a id="vad_0" title="%u4E16%u7EAA%u4F73%u7F18%u5B8C%u7F8E%u65B0%u5A18 @utops.cc" class="vLink9999" style="font-size: 1em;" href="http://action.utops.cc/click.jsp?adsId=245&amp;adsLeagueId=5&amp;adsUserId=188&amp;siteId=657&amp;siteLeagueId=5&amp;siteUserId=564&amp;scId=2&amp;adsType=2&amp;prices=0.85&amp;checkCode=5f495af734de9d6a36abeac7ed9e4393_222.73.161.236&amp;click=1&amp;url=http%3A//www.jiayuan.com/parties/2009/bride/&amp;v=0&amp;keyword=%u6CE8%u610F&amp;s=http%3A//www.linuxidc.com/Linux/2009-05/20226.htm&amp;rn=805474---2010-3-24-0:41:51" target="_blank" onmouseout="if(typeof(showTitle)!='undefined'){mouseIsOverLayer = false; mouseOverWhileLoad = false; hideTO = window.setTimeout('checkIfMouseOverLayer()',500);}">注意</a></span>：安装subversion需要autoconf 2.58或以上版本、libtool 1.4或以上版本、gcc、libapr and libapr-util支持。</span></p><br /><p><br /><span style="color: rgb(0, 0, 255);">1、下载软件</span><br />httpd-2.2.9.tar.gz (<span style="color:#1f5ba4;">http://www.apache.org</span>)<br />subversion-1.5.1.tar.gz (<span style="color:#1f5ba4;">http://subversion.tigris.org/</span>)<br /><br /></p><br /><p><span style="color: rgb(0, 0, 255);">2、编译安装httpd</span>（如果您已经安装过Apache，并且配置Apache时，有这两个参数"--enable-dav --enable-so",则可省略此步骤，否则需要重新编译）<br />先停止apache:<br />/program/apache/bin/apachectl stop<br />然后再重装编译安装apache:<br />tar xvfz httpd-2.2.9.tar.gz <br />cd httpd-2.2.9<br />./configure<br />--prefix=/program/apache --enable-dav=share --enable-so<br />--enable-rewrite=share --enable-proxy=share --enable-proxy-ajp=share<br />--with-apr=/program/apr --with-apr-util=/program/apr-util<br />make<br />make install <br /></p><br /><p>注意：以上配置Apache中的前两个参数（--enable-dav --enable-so）是必须要加的，你还可以根据您的需要添加其他的参数。<br />/program/apache/bin/apachectl start,打开浏览器<span style="color:#1f5ba4;">http://192.168.2.180/</span>,如果有测试页出现则证明已经安装成功。<br /><br /><span style="color: rgb(0, 0, 255);">3、安装Subversion<br /></span>如果之前安装过subversion，则要卸载先前安装的Subversion库文件：<br />rm -f /usr/local/lib/libsvn*<br />rm -f /usr/local/lib/libapr*<br />rm -f /usr/local/lib/libexpat*<br />rm -f /usr/local/lib/libneon*</p><br /><p><br />解压subversion：<br />tar xvfz subversion-1.5.3.tar.gz</p><br /><p>检测Subversion所需的软件是否具备：<br />cd /server/software/subversion-1.5.1<br />sh ./autogen.sh<br />./configure<br />--prefix=/program/subversion --with-apxs=/program/apache/bin/apxs<br />--with-apr=/program/apr --with-apr-util=/program/apr-util<br />make<br />make install<br />运行make tools，在/server/software/subversion-1.5.0中生成tools目录<br />make tools<br />进入tools/server-side目录，里面有svn-populate-node-origins-index文件。</p><br /><p>mkdir -p /server/repository //创建库文件所在的目录<br />/program/subversion/bin/svnadmin create /server/repository/joton //创建名为joton的仓库 <br />/program/subversion/bin/svnadmin create /server/repository/sns //创建名为sns的仓库 <br />去/server/repository/joton看看是不是多了些文件，如果是则说明Subversion安装成功了 </p><br /><p>执行以下命令，使apache的用户nobody对刚才新建立的仓库拥有权限：<br />chown -R nobody /server/repository/joton/</p><br /><p>注:这儿的 nobody 是apache的用户,也有可能是daemon<br /><br /></p><br /><p><span style="color: rgb(0, 0, 255);">4、修改apache，让subversion和apache一起工作</span><br />修改"/program/apache/conf/httpd.conf" ，在最下面添加如下几行： </p><br /><p>(<br />subversion-1.5.3已经自动添加了，如没有则添上<br />LoadModule dav_svn_module modules/mod_dav_svn.so<br />LoadModule authz_svn_module modules/mod_authz_svn.so<br />)</p><br /><p>单个版本库<br /><span style="color: rgb(51, 153, 0);">&lt;Location /svn&gt;<br />DAV svn<br />SVNPath /server/repository/joton<br />AuthType Basic<br />AuthName "Subversion repository"<br />AuthUserFile /server/repository/auth-svn<br />AuthzSVNAccessFile /server/repository/auth-svn.conf<br />Require valid-user<br />&lt;/Location&gt;</span></p><br /><br /><p>多版本库<br /><span style="color: rgb(51, 102, 0);">&lt;Location /svn&gt;<br />DAV svn<br />SVNListParentPath on<br />SVNParentPath /server/repository<br />AuthType Basic<br />AuthName " Subversion repository "<br />AuthUserFile /server/repository/auth-svn<br />AuthzSVNAccessFile /server/repository/auth-svn.conf<br />Require valid-user<br />&lt;/Location&gt;</span></p><br /><p>创建权限文件<br />touch –p /server/repository/auth-svn.conf<br />下面，就要写这个auth-svn.conf文件了，它是用来控制用户访问仓库的权限的，我们把说明写在后面<br /><span style="color: rgb(102, 153, 0);">[svn1:/] //这表示，仓库svn1的根目录下的访问权限<br />dl1 = rw // svn1仓库dl1用户具有读和写权限<br />dl2 = rw // svn1仓库dl2用户具有读和写权限<br />dl3 = r // svn1仓库dl3用户具有读权限<br />[svn2:/] //svn2仓库根目录下的访问权限<br />harry = r // harry用户在svn2仓库根目录下只有读权限<br />sally = // sally用户在 svn2仓库根目录下无任何权限<br />#[/] // 这个表示在所有仓库的根目录下<br />#* = r // 这个表示对所有的用户都具有读权限<br />#[groups] // 这个表示群组设置<br />#svn1-developers = harry, sally // 这个表示某群组里的成员<br />#svn2-developers = sally<br />#[svn1:/]</span> <br /><span style="color: rgb(102, 204, 0);">#@svn1-developers</span><span style="color: rgb(102, 204, 0);"> = rw // 如果在前面加上@符号，则表示这是个群组权限设置</span></p><br /><p>下面来创建访问有权限的subversion帐号：<br />/program/apache/bin/htpasswd -cm /server/repository/auth-svn chenggang //创建一个名为chenggang的用户。<br />执行这个命令成功以后就会在/program/apache/bin目录下建立一个passwd文件，之后如果再加入新的用户和更改已有用户的密码，执行<br />/program/apache/bin/htpasswd /server/repository/auth-svn &lt;username&gt;即可。<br />删除某个帐号:打开/server/svn/auth-svn这个文件,直接删除相关的行.</p><br /><p>/program/apache/bin/apachectl restart <br />重启apache,打开浏览器访问<span style="color:#1f5ba4;">http://192.168.1.1/svn/joton/</span>，如果有东西显示就说明成功。如果不能正确的显示，你看看您的"/server/repository"目录是否对apache的用户是可写的就可以了。</p><br /><p>到此为止，在Linux上安装Subversion已经成功！</p><br /><p><br /><br /></p><br /><p><span style="color: rgb(0, 0, 255);">##########遇见问题##############<br /></span>我在安装过程中遇到的问题：<br />1、找不到/server/soft/apache/modules/mod_dav_svn.so这个文件？</p><br /><p>解决方法：</p><br /><p>配置subversion时：<br />--with-apxs2=/server/soft/apache/bin/apxs<br />应该为：<br />--with-apxs=/server/soft/apache/bin/apxs</p><br /><p>2、访问 <span style="color:#1f5ba4;">http://192.168.2.180/svn/***</span> ,提示You don't have permission to access /svn/xingmo on this server.</p><br /><p>解决方法：<br />&lt;Location /svn&gt;<br />DAV svn<br />SVNParentPath /server/repository<br />Options Indexes MultiViews<br />&lt;/Location&gt;<br />改为：<br />&lt;Location /svn/xingmo&gt;<br />DAV svn<br />#SVNParentPath /server/repository<br />SVNPath /server/repository/xingmo/<br />Options Indexes MultiViews<br />&lt;/Location&gt;<br /><br /></p><br /><p>3、向服务器import时，提示：<br />Error: Commit failed (details follow): <br />Error: Can't create directory '/server/repository/xingmo/db/transactions/0-1.txn': <br />Error: Permission denied </p><br /><p>解决方法：<br />chown -R nobody /server/repository/xingmo/<br />/server/soft/apache/bin/apachectl restart</p><br /><p>或:<br />chown -R nobody /server/repository<br />/server/soft/apache/bin/apachectl restart<br />注:这儿的 nobody 是apache的用户,也有可能是daemon</p><br /><p><br />文中的路径及相关参数，可以根据自己的情况有所不同。<br /><br />4、<br />Syntax error on line 413 of /program/apache/conf/httpd.conf:<br />AuthzSVNAccessFile not allowed here</p><br /><p>读写权限问题<br />把apache配置文件中的用户赋值对svn仓库的读写权限就OK了，比如：chown -R nobody /server/repository<br /><br />新建一个svn库:</p><br />/program/subversion/bin/svnadmin create /server/repository/work //创建名为work的仓库 <br />chown -R nobody /server/repository/work/ <br /><br />添加帐号：<br />/soft/apache/bin/htpasswd /server/repository/auth-svn &lt;username&gt;</div><div class="entry-tags"><strong>Tags:</strong><a href="http://sk2.com/tag/linux/">linux</a>,<a href="http://sk2.com/tag/svn/">svn</a></div></div><ul id="flip2" class="flip"><li>Newer:<a href="http://sk2.com/post/130.html">linux常用svn命令</a></li><li>Older:<a href="http://sk2.com/post/128.html">MYSQL常用SQL命令（3）</a></li></ul></div>
<div id="footer"><div><a rel="nofollow" class="admin" href="http://sk2.com/login"><small>ADMIN</small></a><address>&copy; 2010 <a href='http://sk2.com/'>blog.sk80.com</a></address></div></div></div></div><script type="text/javascript" src="http://sk2.com/include/js/resize.js"></script><script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">try {var pageTracker = _gat._getTracker("UA-5695529-2");pageTracker._trackPageview();} catch(err) {}</script></body></html>

<script language="javascript" type="text/javascript" src="http://js.users.51.la/3688801.js"></script>
<noscript><a href="http://www.51.la/?3688801" target="_blank"><img alt="&#x6211;&#x8981;&#x5566;&#x514D;&#x8D39;&#x7EDF;&#x8BA1;" src="http://img.users.51.la/3688801.asp" style="border:none" /></a></noscript>